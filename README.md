## Marine vessel information Server


# 리팩토링(2025.04.21 ~)

### 문제점 분석

1. parsingdata() 메서드가 너무 많은 기능을 담당하고 있음.
2. 하드 코딩 요소 다수(서버 주소 직접입력, 상수 변수 직접 사용 등)
3. 서버 구성요소 재구성 필요
4. 예외 처리 필요(커스텀 예외 객체를 생성 후 상황에 맞게 예외를 발생시켜야함) 


###가설 
1. 기능 분리를 하면 가독성과 재사용성이 향상할 것임
2. 무분별하게 사용된 상수 변수를 상수 클래스를 따로 생성하여 관리하거나 static final 상수로 정의하면 코드줄 감소, 재사용성과 가독성이 향상될 것임
3. 도메인/비즈니스 로직 분리, 계층형 구조 (통신 계층 -> 데이터 가공 계층 -> DB 저장 -> 가공 데이터 전송 계층) 적용하면 유지보수성이 향상될 것임
4. 상황에 따른 예외처리를 수행하면 서버의 오류 메시지 노출이 최소화 될 것임 EX) DB 저장에 실패하였을 시 예외 처리 후 클라이언트에 데이터 전송 미수행, 통신 계층에서 데이터 수신 오류가 발생했을 때 예외 처리 후 클라이언트에 메시지 전송 등

## 기능 분리
### 가설 
데이터 수신부와 디코딩부를 서로 다른 클래스로 분리하여 결합도를 낮출 수 있음  
while문으로 수신 데이터를 감시하고 있는 것을 이벤트 처리(Java NIO) 방식을 통해 자원 사용률을 낮출 수 있음 


과거 코드 passingData() 라는 한 메서드가 너무 많은 기능을 담당하고 있었음(메시지 타입 분류 및 디코딩, 웹 클라이언트에 메시지 전송, 서버로 부터 메시지 수신)

통신 계층   
- TcpReciver : 서버로 부터 메시지 수신 담당
- Transmit : 클라이언트에게 메시지 송신 담당
- WebSocket : 웹 소켓 연결과 엔드포인트 담당

디코딩 계층
- Calculator : 선박의 미래 항로 계산 담당
- Decoder : AIS 신호 디코딩
- ExternalApi : 해양수산부 API 연결 담당

DB 계층
- Dao : 가공된 데이터 저장 담당

Config 파일
- MyBatisDbHandler : Configuration.xml 파일을 로드하여 db 연결 담당

으로 분류

## 파티셔닝
문제점 분석

1. 하나의 테이블에 선박 위치정보를 저장하여 테이블 크기가 커짐에 따라 과거 항적 조회시 SELECT 성능 저하 발생

가설

2. 날짜별로 조회를 한다는 점에 기반하여 날짜별로 테이블을 분리하면 SELECT 시 데이터 개수가 감소할 것임
